{"version":3,"file":"select-all.min.js","sources":["../src/select-all.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS handler for select all functionality\n *\n * @copyright  2022 Matthias Tylkowski <matthias.tylkowski@b-tu.de>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport Selectors from './local/select-all/selectors';\n\nconst registerEventListeners = () => {\n    const masterElem = document.querySelector(Selectors.selectors.masterSelector);\n    const checkboxElems = Array.from(document.querySelectorAll(Selectors.selectors.checkboxesSelector));\n    /** @var HTMLButtonElement */\n    const submitButtonElem = document.querySelector(Selectors.selectors.submitSelector);\n    submitButtonElem.disabled = true;\n\n    if (!masterElem) {\n        throw new Error('select all element doesn\\'t exist');\n    }\n\n    masterElem.addEventListener('change', e => {\n        const state = e.target.checked;\n\n        submitButtonElem.disabled = !state;\n\n        if (state === true) {\n            checkAll();\n        } else {\n            uncheckAll();\n        }\n    });\n\n    document.addEventListener('change', e => {\n        // Ignore masterElem or other Elements which are not in checkBoxElems Array.\n        if (e.target === masterElem || checkboxElems.includes(e.target) === false) {\n            return;\n        }\n\n        const allChecked = checkboxElems.every((elem) => elem.checked === true);\n        const allUnchecked = checkboxElems.every((elem) => elem.checked === false);\n\n        submitButtonElem.disabled = allUnchecked;\n\n        if (allChecked === true) {\n            masterToChecked();\n            return;\n        }\n\n        if (allUnchecked === true) {\n            masterToUnchecked();\n            return;\n        }\n\n        masterToIndeterminate();\n    });\n\n    const checkAll = () => {\n        checkboxElems.forEach((elem) => {\n            elem.checked = true;\n        });\n    };\n\n    const uncheckAll = () => {\n        checkboxElems.forEach((elem) => {\n            elem.checked = false;\n        });\n    };\n\n    const masterToIndeterminate = () => {\n        masterElem.indeterminate = true;\n        masterElem.checked = false;\n    };\n\n    const masterToChecked = () => {\n        masterElem.indeterminate = false;\n        masterElem.checked = true;\n    };\n\n    const masterToUnchecked = () => {\n        masterElem.indeterminate = false;\n        masterElem.checked = false;\n    };\n};\n\nexport const init = () => {\n    registerEventListeners();\n};\n"],"names":["masterElem","document","querySelector","Selectors","selectors","masterSelector","checkboxElems","Array","from","querySelectorAll","checkboxesSelector","submitButtonElem","submitSelector","disabled","Error","addEventListener","e","state","target","checked","checkAll","uncheckAll","includes","allChecked","every","elem","allUnchecked","masterToIndeterminate","masterToUnchecked","masterToChecked","forEach","indeterminate","registerEventListeners"],"mappings":";;;;;;8JAmGoB,KA3EW,YACrBA,WAAaC,SAASC,cAAcC,mBAAUC,UAAUC,gBACxDC,cAAgBC,MAAMC,KAAKP,SAASQ,iBAAiBN,mBAAUC,UAAUM,qBAEzEC,iBAAmBV,SAASC,cAAcC,mBAAUC,UAAUQ,mBACpED,iBAAiBE,UAAW,GAEvBb,iBACK,IAAIc,MAAM,oCAGpBd,WAAWe,iBAAiB,UAAUC,UAC5BC,MAAQD,EAAEE,OAAOC,QAEvBR,iBAAiBE,UAAYI,OAEf,IAAVA,MACAG,WAEAC,gBAIRpB,SAASc,iBAAiB,UAAUC,OAE5BA,EAAEE,SAAWlB,aAAmD,IAArCM,cAAcgB,SAASN,EAAEE,qBAIlDK,WAAajB,cAAckB,OAAOC,OAA0B,IAAjBA,KAAKN,UAChDO,aAAepB,cAAckB,OAAOC,OAA0B,IAAjBA,KAAKN,UAExDR,iBAAiBE,SAAWa,cAET,IAAfH,YAKiB,IAAjBG,aAKJC,wBAJIC,oBALAC,2BAYFT,SAAW,KACbd,cAAcwB,SAASL,OACnBA,KAAKN,SAAU,MAIjBE,WAAa,KACff,cAAcwB,SAASL,OACnBA,KAAKN,SAAU,MAIjBQ,sBAAwB,KAC1B3B,WAAW+B,eAAgB,EAC3B/B,WAAWmB,SAAU,GAGnBU,gBAAkB,KACpB7B,WAAW+B,eAAgB,EAC3B/B,WAAWmB,SAAU,GAGnBS,kBAAoB,KACtB5B,WAAW+B,eAAgB,EAC3B/B,WAAWmB,SAAU,IAKzBa"}